space: O(logn)
time: O(n)
